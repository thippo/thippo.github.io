<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>资产负债表</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #f0f5ff 0%, #e6f0ff 100%);
            padding: 20px;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 40px;
            font-size: 32px;
            font-weight: 600;
            letter-spacing: 0.5px;
            position: relative;
            padding-bottom: 15px;
        }
        
        h1:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(to right, #3498db, #2c3e50);
            border-radius: 2px;
        }
        
        .date {
            text-align: right;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 16px;
            font-weight: 500;
        }
        
        .balance-sheet {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .section {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(236, 240, 241, 0.8);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.1);
        }
        
        .section-title {
            font-size: 22px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #3498db;
            position: relative;
        }
        
        .section-title:after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 80px;
            height: 2px;
            background: #3498db;
        }
        
        .category {
            margin-bottom: 20px;
            background: rgba(236, 240, 241, 0.3);
            border-radius: 8px;
            padding: 15px;
            transition: background 0.3s ease;
        }
        
        .category:hover {
            background: rgba(236, 240, 241, 0.5);
        }
        
        .category-title {
            font-size: 18px;
            font-weight: 600;
            color: #34495e;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            padding: 8px 12px;
            background: rgba(52, 152, 219, 0.1);
            border-radius: 6px;
        }
        
        .item {
            display: flex;
            justify-content: space-between;
            padding: 8px 20px;
            font-size: 16px;
            color: #2c3e50;
            transition: background 0.2s ease;
            border-radius: 4px;
        }
        
        .item:hover {
            background: rgba(236, 240, 241, 0.4);
        }
        
        .item-name {
            flex: 1;
        }
        
        .item-amount {
            font-weight: 500;
            color: #27ae60;
            font-family: 'Courier New', monospace;
            font-size: 17px;
        }
        
        .liability .item-amount {
            color: #e74c3c;
        }
        
        .total {
            display: flex;
            justify-content: space-between;
            padding: 15px 20px;
            font-size: 20px;
            font-weight: 600;
            margin-top: 20px;
            border-top: 2px solid #3498db;
            background: rgba(52, 152, 219, 0.05);
            border-radius: 8px;
            color: #2c3e50;
        }
        
        .equity-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 20px;
            font-size: 17px;
            color: #2c3e50;
            transition: background 0.2s ease;
            border-radius: 6px;
        }
        
        .equity-item:hover {
            background: rgba(236, 240, 241, 0.4);
        }
        
        .equity-item.total {
            background: rgba(52, 152, 219, 0.15);
            font-size: 22px;
            font-weight: 600;
            margin-top: 15px;
            border-top: 2px solid #3498db;
            color: #2c3e50;
        }
        
        .amount {
            font-family: 'Courier New', monospace;
            font-weight: 500;
        }
        
        .positive {
            color: #27ae60;
            font-weight: 600;
        }
        
        .negative {
            color: #e74c3c;
            font-weight: 600;
        }
        
        .zero {
            color: #95a5a6;
            font-weight: 500;
        }
        
        .summary {
            margin-top: 40px;
            padding: 25px;
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            border-radius: 12px;
            color: white;
            text-align: center;
            box-shadow: 0 8px 24px rgba(52, 152, 219, 0.3);
        }
        
        .summary h3 {
            font-size: 24px;
            margin-bottom: 15px;
            font-weight: 500;
            letter-spacing: 0.5px;
        }
        
        .summary-amount {
            font-size: 42px;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        @media (max-width: 768px) {
            .balance-sheet {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 25px;
            }
            
            h1 {
                font-size: 28px;
            }
            
            .section-title {
                font-size: 20px;
            }
            
            .item {
                font-size: 15px;
            }
            
            .total {
                font-size: 18px;
            }
            
            .equity-item {
                font-size: 16px;
            }
            
            .summary-amount {
                font-size: 36px;
            }
        }
        
        .detail-toggle {
            cursor: pointer;
            color: #3498db;
            font-size: 14px;
            margin-left: 10px;
            font-weight: 500;
            transition: color 0.2s ease;
        }
        
        .detail-toggle:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        
        .detail-content {
            display: none;
            padding: 15px;
            background: rgba(236, 240, 241, 0.4);
            font-size: 14px;
            white-space: pre-wrap;
            margin-top: 10px;
            border-radius: 8px;
            border-left: 3px solid #3498db;
            color: #2c3e50;
            line-height: 1.7;
        }
        
        .detail-content.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .right-column {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        /* 新增图表容器样式 */
        .chart-section {
            margin-top: 40px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(236, 240, 241, 0.8);
        }
        
.chart-container {
  position: relative;
  width: 100%;
  height: 400px;   /* 保持高度即可 */
}
#chartCanvas {
  width: 100% !important;
  height: 100% !important;
  display: block;
}
        
        .chart-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
        }
        
        .time-selector {
            padding: 8px 16px;
            border: 2px solid #3498db;
            border-radius: 6px;
            background: white;
            color: #2c3e50;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .time-selector:hover {
            background: #3498db;
            color: white;
        }
        
        .time-selector.active {
            background: #3498db;
            color: white;
        }
        
        .chart-info {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding: 15px;
            background: rgba(52, 152, 219, 0.05);
            border-radius: 8px;
            font-size: 14px;
            color: #2c3e50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>资产负债表</h1>
        <div class="date" id="currentDate"></div>
        
        <div class="balance-sheet">
            <div class="assets-section">
                <div class="section-title">资产</div>
                <div id="assetsContent"></div>
                <div class="total">
                    <span>资产总计</span>
                    <span class="amount" id="totalAssets">0.00</span>
                </div>
            </div>
            
            <div class="right-column">
                <div class="liability-section">
                    <div class="section-title">负债</div>
                    <div id="liabilityContent"></div>
                    <div class="total">
                        <span>负债总计</span>
                        <span class="amount" id="totalLiabilities">0.00</span>
                    </div>
                </div>
                
                <div class="equity-section">
                    <div class="section-title">所有者权益</div>
                    <div class="equity-item">
                        <span>实收资本</span>
                        <span class="amount" id="paidInCapital">0.00</span>
                    </div>
                    <div class="equity-item">
                        <span>盈余公积</span>
                        <span class="amount" id="reservesCapital">0.00</span>
                    </div>
                    <div class="equity-item">
                        <span>未分配利润</span>
                        <span class="amount" id="undistributedProfit">0.00</span>
                    </div>
                    <div class="equity-item total">
                        <span>所有者权益合计</span>
                        <span class="amount" id="totalEquity">0.00</span>
                    </div>
                    <div class="equity-item">
                        <span>月度总结</span>
                        <span class="amount" id="summary">0.00</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 新增图表部分 -->
        <div class="chart-section">
            <div class="section-title">资产走势日K图</div>
            <div class="chart-controls">
                <button class="time-selector active" data-range="all">全部</button>
                <button class="time-selector" data-range="1y">近1年</button>
                <button class="time-selector" data-range="6m">近6月</button>
                <button class="time-selector" data-range="3m">近3月</button>
            </div>
<div class="chart-container">
  <canvas id="chartCanvas"></canvas>
</div>
            <div class="chart-info">
                <span id="chartDate">日期: -</span>
                <span id="chartOpen">开盘: -</span>
                <span id="chartClose">收盘: -</span>
                <span id="chartHigh">最高: -</span>
                <span id="chartLow">最低: -</span>
            </div>
        </div>
        
    </div>

    <script>
        // 数据定义
        const assets_data = [
            ['货币资金', '建行银行数字人民币', 0.0, '','cash'],
            ['货币资金', '建行银行现金', 0.0, '','cash'],
            ['货币资金', '建行银行龙钱宝1号', 10076.44, '','cash'],
            ['货币资金', '建行银行龙钱宝2号', 544080.91, '','cash'],
            ['货币资金', '工商银行现金', 6060, '','cash'],
            ['货币资金', '工商银行天天盈', 153383.66, '','cash'],
            ['货币资金', '北京银行现金', 0.0, '','cash'],
            ['货币资金', '微信零钱', 15.34, '','cash'],
            ['货币资金', '微信MiniFund', 0.0, '','cash'],
            ['货币资金', '余利宝', 2.59, '','cash'],
            ['货币资金', '京东小金库', 99.64, '','cash'],
            ['货币资金', '中信现金', 44552.84, '','cash'],
            ['大宗商品', '豆粕ETF159985', 85756.0, '','commodities'],
            ['金融资产', '225ETF513000', 88920.0, '','stock'],
            ['金融资产', '东证ETF513800', 42183.0, '','stock'],
        ];

        const liability_data = [
            ['长期借款', '家产委托', 100000.0, '\
                            2025-05-17  50000.0 买车钱\n\
                            2023-03-30  -50000.0 MFIN学费\n\
                            2021-03-31  -100000.0 三金衣服\n\
                            2021-03-07  200000.0 婚礼\n\
                            2020-12-02  -520000.0 归还（含利息）\n\
                            2020-12-02  10000.0 再一笔\n\
                            2020-05-16  220000 再一笔\n\
                            2020-04-17  150000 又一笔\n\
                            2020-01-16  20000 日本归来\n\
                            2020-01-04  120000 第一笔'],
            ['长期借款', '母亲委托', 53500.0, '\
                            2024-04-14  2000 修车转给我的\n\
                            2022-05-31  4000 MFIN学费多出来的\n\
                            2018-10-19  7000 回龙观房租\n\
                            2018-08-31  200 微信房租\n\
                            2018-08-30  300 微信房租\n\
                            2018-04-09  30000 姑妈三万\n\
                            2018-02-27  10000 第一笔'],
            ['长期借款', '父亲委托', 176648.36, '\
                            2025-11-12   2000   买大路灯\n\
                            2025-09-29   2000   月饼里红包\n\
                            2025-03-16   1000   4s店保养\n\
                            2025-03-02   2000   农商行转账\n\
                            2025-02-22   6800   农商行转账\n\
                            2024-10-22   5000   农商行转账\n\
                            2021-10-10   20000   过户\n\
                            2021-09-16   200   肠镜缴费\n\
                            2021-02-20   5000   婚庆订金\n\
                            2021-01-16   1000   床退款\n\
                            2020-11-00   2700   装修物业费\n\
                            2020-04-07   10000   一万\n\
                            2020-02-17   600   加油\n\
                            2019-10-19   10000   于静文\n\
                            2019-06-02   20000   调解过户\n\
                            2019-05-21   2400    跳绳\n\
                            2019-02-05   10000   转账\n\
                            2019-02-04   600     红包\n\
                            2019-01-31   3000    年底分红\n\
                            2018-09-21   4000    还保险费\n\
                            2018-09-21   -3500   追尾保险\n\
                            2018-09-08   5000    房产过户\n\
                            2018-04-22   50000   工行转账\n\
                            2018-01-14   86      修车费剩余\n\
                            2017-08-28   1062.36 港澳游 0.8365 1270\n\
                            2017-08-12   5000    广告屏\n\
                            2017-08-06   4700    住院\n\
                            2017-08-03   3000    键盘抽屉\n\
                            2017-07-28   3000    第一笔'],
            ['长期借款', '耿高惠委托', 120473.42, '\
                            2023-09-14  -5000 买黄金50g\n\
                            2022-04-11  552.42 积存金\n\
                            2021-09-17  500 基金定投\n\
                            2021-09-09  1000 基金定投\n\
                            2021-08-16  521 买黄金\n\
                            2021-08-10  900 买黄金\n\
                            2021-08-09  2000 还花呗\n\
                            2021-06-29  20000 还信用卡\n\
                            2021-03-31  -21054 还一笔\n\
                            2021-03-31  -30000 还一笔\n\
                            2021-03-29  30000 存红包\n\
                            2021-03-25  -10000 还一笔\n\
                            2021-03-24  -20000 还一笔\n\
                            2021-03-23  -20000 还一笔\n\
                            2021-03-23  64680 婚庆\n\
                            2021-03-04  11700 婚庆\n\
                            2021-02-19  -1349 衣服包包鞋子\n\
                            2021-02-18  -5000 对戒\n\
                            2021-02-17  -2000 租婚纱\n\
                            2021-02-16  -24856 三金\n\
                            2021-01-29  240 东里电费\n\
                            2021-01-24  500 牛币\n\
                            2021-01-21  3000 白条还款\n\
                            2021-01-15  100000 三金衣服钱\n\
                            2021-01-14  -3400 床退款\n\
                            2021-01-08  11000 花呗还款\n\
                            2021-01-06  12600 家具\n\
                            2020-12-25  -2261 空调\n\
                            2020-11-29  5001 对戒\n\
                            2020-10-16  300 补300\n\
                            2020-10-14  900 第一笔'],
            ['长期借款', '儿子委托', 0.0, '\
                            2025-01-22  转到民生银行\n\
                            2024-11-29  16 爸爸给的\n\
                            2024-10-03  1000 二姑妈二姑夫给的\n\
                            2024-10-03  300 于静文奶奶给的\n\
                            2024-10-02  2000 奶奶给的\n\
                            2024-06-11  0.59 爸爸给的\n\
                            2024-05-28  50000.0 爷爷奶奶给的\n\
                            2024-05-14   99.4   妈妈给的\n\
                            2024-04-15   75.91   妈妈给的\n\
                            2024-01-22   1039.97   妈妈给买的易存金2.1198克\n\
                            2024-01-08   679.96   爸爸给买的易存金1.3809克\n\
                            2021-09-23   301   妈妈建行基金\n\
                            2021-09-22   301   妈妈建行基金\n\
                            2021-09-10   301   妈妈建行基金\n'],
            ['短期借款', '创新基金', 9698, '', '\
                            2020-12-18   6750.00   第二笔\n\
                            2020-11-30   -6.00   查重\n\
                            2020-11-29   -3.00   查重\n\
                            2020-05-13   -657.00   塑料收纳箱\n\
                            2020-05-05   -936.00   乒乓球桌\n\
                            2020-04-24   -2500   刘振源\n\
                            2020-04-24   -200   CCF\n\
                            2019-xx-xx   7250   第一笔'],
            ['短期借款', '工行牡丹卡', 71.56, ''],
            ['短期借款', '蚂蚁花呗', 748.49, ''],
            ['短期借款', '京东白条', 0.0, ''],
            ['短期借款', '建行visa卡', 0.0, ''],
            ['短期借款', '建行扶贫卡', 418.71, ''],
            ['短期借款', '保险', 0.0, ''],
        ];

        const paidin_capital_data = 513571.88;
        const reserves_capital_data = 0.0;

        // 月K线数据
        const month_data = [
            ['2018/1/31', 84639.92, 88690.68999999999, 83720.68999999999, 89609.92],
            ['2018/2/28', 88690.69, 91019.23, 87769.23, 91940.69],
            ['2018/3/31', 91019.23, 100663.18000000002, 91019.23, 100663.18000000002],
            ['2018/4/30', 100663.18, 104463.33999999998, 99763.33999999998, 105363.18],
            ['2018/5/31', 104463.34, 106547.65000000002, 102007.65000000002, 109003.34],
            ['2018/6/30', 106547.65, 110635.13, 106547.65, 110635.13],
            ['2018/7/31', 110635.13, 100209.96, 97749.96, 113095.13],
            ['2018/8/31', 100209.96, 101431.3, 99831.3, 101809.96],
            ['2018/9/30', 101431.3, 106818.83999999994, 100427.83999999994, 107822.3],
            ['2018/10/31', 106818.84, 106521.81999999995, 101221.81999999995, 112118.84],
            ['2018/11/30', 106521.82, 106553.00000000003, 102753.00000000003, 110321.82],
            ['2018/12/31', 106553.0, 114449.57, 100111.17, 120891.4],
            ['2019/1/31', 114449.57, 128018.75999999998, 104516.28999999998, 137952.04],
            ['2019/2/28', 128018.76, 130391.00999999998, 115903.79999999999, 142505.97],
            ['2019/3/31', 130391.01, 143301.14, 128409.31000000001, 145282.84],
            ['2019/4/30', 143301.14, 158512.20999999996, 132599.42999999996, 169213.92],
            ['2019/5/31', 158512.21, 170387.68999999994, 155133.8, 173766.09999999998],
            ['2019/6/30', 170387.69, 185200.2, 170387.69, 185200.2],
            ['2019/7/31', 185200.2, 191886.36000000016, 177854.22000000015, 199232.34000000003],
            ['2019/8/31', 191886.36, 203606.44000000003, 190417.47000000003, 205075.33 ],
            ['2019/9/30', 203606.44, 214435.01000000004, 198745.18000000005, 219296.27 ],
            ['2019/10/31', 214435.01, 236767.21000000002, 205834.08000000002, 245368.14 ],
            ['2019/11/30', 236767.21, 247476.39999999997, 234543.26999999996, 249700.34 ],
            ['2019/12/31', 247476.4, 255877.24000000002, 242965.79, 260387.85 ],
            ['2020/1/31', 255877.24, 261785.155, 236208.545, 281453.85 ],
            ['2020/2/29', 261785.15, 281088.69851299986, 261785.15, 281088.69851299986 ],
            ['2020/3/31', 281088.7, 294167.208513, 278525.518513, 296730.39 ],
            ['2020/4/30', 294167.21, 300093.42851299996, 278304.198513, 315956.44 ],
            ['2020/5/31', 300093.43, 313013.0185129999, 297702.7985129999, 315403.64999999997 ],
            ['2020/6/30', 313013.02, 323909.428513, 309671.298513, 327251.15 ],
            ['2020/7/31', 323909.43, 360421.1185130002, 323909.43, 360421.1185130002 ],
            ['2020/8/31', 360421.12, 362284.65851300023, 351267.92851300025, 371437.852 ],
            ['2020/9/30', 362284.66, 452806.7285130002, 362284.66, 452806.7285130002 ],
            ['2020/10/31', 452806.73, 461753.17851300014, 449311.30851300014, 464948.6 ],
            ['2020/11/30', 461753.18, 439076.758513, 428884.888513, 471945.05 ],
            ['2020/12/31', 439076.76, 387318.918513, 376793.148513, 449602.53 ],
            ['2021/1/31', 387318.92, 294242.09851300006, 269946.43851300003, 411614.57999999996 ],
            ['2021/2/28', 294242.1, 269185.43851299997, 258514.30851299996, 309913.23 ],
            ['2021/3/31', 269185.43851299997, 263256.51, 252493.26851300004, 279948.68 ],
            ['2021/4/30', 263256.51, 277536.5228129999, 261746.7528129999, 279046.28 ],
            ['2021/5/31', 277536.52, 254282.23851300008, 242777.91851300007, 289040.84 ],
            ['2021/6/30', 254282.24, 262435.378513, 251554.048513, 265163.57 ],
            ['2021/7/31', 262435.378513, 259044.09351300003, 248851.103513, 269237.08 ],
            ['2021/8/31', 259044.09, 258732.66351299998, 245974.11351299996, 271802.64 ],
            ['2021/9/30', 258732.66, 271020.613513, 258732.66, 271020.613513 ],
            ['2021/10/31', 271020.61, 293540.58951300004, 271020.61, 293540.58951300004 ],
            ['2021/11/30', 293540.59, 303236.49351300014, 292504.86351300013, 304272.22000000003 ],
            ['2021/12/31', 303236.49, 311393.4235130002, 299761.7935130002, 314868.12 ],
            ['2022/1/31', 311393.42, 371410.249513, 311393.42, 371410.249513 ],
            ['2022/2/28', 371410.25, 396208.381513, 371410.25, 396208.381513 ],
            ['2022/3/31', 396208.38, 392774.8965129999, 381638.4565129999, 407344.82 ],
            ['2022/4/30', 392774.9, 397374.75351300015, 380418.31351300015, 409731.34 ],
            ['2022/5/31', 397374.75, 403267.36651300004, 393255.24651300005, 407386.87 ],
            ['2022/6/30', 403267.37, 402757.5805130001, 392591.1405130001, 413433.81 ],
            ['2022/7/31', 402757.58, 419644.31551299995, 402757.58, 419644.31551299995 ],
            ['2022/8/31', 419644.32, 424485.29351299995, 413422.85351299995, 430706.76 ],
            ['2022/9/30', 424485.29, 414243.45851300017, 401547.94851300016, 437180.8 ],
            ['2022/10/31', 414243.46, 424245.5885129999, 413440.06851299986, 425048.98000000004 ],
            ['2022/11/30', 424245.59, 388019.5335130001, 369114.0235130001, 443151.10000000003 ],
            ['2022/12/31', 388019.53, 399872.87421000004, 388019.53, 399872.87421000004 ],
            ['2023/1/31', 399872.87, 417028.379448, 383056.409448, 433844.83999999997 ],
            ['2023/2/28', 417028.38, 426518.6143650001, 415181.4743650001, 428365.52 ],
            ['2023/3/31', 426518.61, 437467.7909700001, 426210.7409700001, 437775.66 ],
            ['2023/4/30', 437467.79, 430329.17234700004, 408899.24234700005, 458897.72 ],
            ['2023/5/31', 430329.17, 402355.05231299996, 391098.002313, 441586.22 ],
            ['2023/6/30', 402355.05, 408285.9564780001, 397313.86647800007, 413327.14 ],
            ['2023/7/31', 408285.96, 444327.4967929999, 408285.96, 444327.4967929999 ],
            ['2023/8/31', 444327.5, 439322.97579800006, 428490.17579800007, 455160.3 ],
            ['2023/9/30', 439322.98, 441735.50260000007, 430902.7026000001, 450155.77999999997 ],
            ['2023/10/31', 444322.98, 439400.35785600013, 420467.55785600014, 463255.77999999997 ],
            ['2023/11/30', 439400.36, 442809.43448799994, 431976.63448799995, 450233.16 ],
            ['2023/12/31', 442809.43, 446518.81905999983, 435726.00905999984, 453602.24 ],
            ['2024/1/31', 446518.82, 469857.17525700014, 437988.88525700016, 478387.11 ],
            ['2024/2/29', 469857.18, 487352.42620700004, 469857.18, 487352.42620700004 ],
            ['2024/3/31', 487352.43, 501467.36898999976, 487352.43, 501467.36898999976 ],
            ['2024/4/30', 501467.37, 510986.17947200016, 489068.5194720002, 523385.02999999997 ],
            ['2024/5/31', 510986.18, 504130.63804400025, 492844.1680440003, 522272.64999999997 ],
            ['2024/6/30', 504130.64, 481781.562986, 469925.872986, 515986.33 ],
            ['2024/7/31', 481781.56, 496019.4522040001, 477086.6522040001, 500714.36 ],
            ['2024/8/31', 496019.45, 498854.02345400024, 488340.54345400026, 506532.93 ],
            ['2024/9/30', 498854.02, 517251.175827, 498854.02, 517251.175827 ],
            ['2024/10/31', 517251.18, 532707.356532, 514093.876532, 535864.66 ],
            ['2024/11/30', 532707.36, 552325.697699, 532707.36, 552325.697699 ],
            ['2024/12/31', 552325.7, 543928.315503, 532964.8355030001, 563289.1799999999 ],
            ['2025/1/31', 543928.32, 575344.027335, 538786.537335, 580485.8099999999 ],
            ['2025/2/28', 575344.03, 589812.283384, 575344.03, 589812.283384 ],
            ['2025/3/31', 589812.28, 602037.742571, 581671.652571, 610178.37 ],
            ['2025/4/30', 602037.74, 624237.4344879999, 602037.74, 624237.4344879999 ],
            ['2025/5/31', 624237.43, 602580.9446380003, 590474.6346380003, 636343.7400000001 ],
            ['2025/6/30', 602580.94, 610773.3482080002, 599774.1182080002, 613580.1699999999 ],
            ['2025/7/31', 610773.35, 621688.7941210002, 602805.3141210002, 629656.83 ],
            ['2025/8/31', 621688.79, 500985.51000000007, 490196.6900000001, 632477.61 ],
            ['2025/9/30', 500985.51, 507266.9800000001, 496478.1500000001, 511774.34 ],
            ['2025/10/31', 507266.98, 528446.1900000002, 507266.98, 528446.1900000002 ],
            ['2025/11/30', 528446.19, 509456.4899999998, 498667.66999999987, 539235.0099999999 ],
            ['2025/12/31', 509456.49, 513571.8799999999, 498064.1699999999, 524964.2 ],
        ];

        // 格式化金额
        function formatAmount(amount) {
            if (amount === 0) return '0.00';
            return amount.toLocaleString('zh-CN', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }

        function formatSummary(month) {
            return month[0]+', '+month[1]+', '+month[2]+', '+month[3]
        }

        // 获取金额样式类
        function getAmountClass(amount) {
            if (amount > 0) return 'positive';
            if (amount < 0) return 'negative';
            return 'zero';
        }

        // 显示当前日期
        function showCurrentDate() {
            const date = new Date();
            const dateStr = date.toLocaleDateString('zh-CN', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('currentDate').textContent = `日期：${dateStr}`;
        }

        // 渲染资产部分
        function renderAssets() {
            const container = document.getElementById('assetsContent');
            const categories = {};
            let totalAssets = 0;

            // 按类别分组
            assets_data.forEach(item => {
                const category = item[0];
                const name = item[1];
                const amount = item[2];
                
                if (!categories[category]) {
                    categories[category] = {
                        items: [],
                        total: 0
                    };
                }
                
                categories[category].items.push({ name, amount });
                categories[category].total += amount;
                totalAssets += amount;
            });

            // 渲染HTML
            let html = '';
            for (const [category, data] of Object.entries(categories)) {
                html += `
                    <div class="category">
                        <div class="category-title">
                            <span>${category}</span>
                            <span class="amount ${getAmountClass(data.total)}">${formatAmount(data.total)}</span>
                        </div>
                `;
                
                data.items.forEach(item => {
                    html += `
                        <div class="item">
                            <span class="item-name">${item.name}</span>
                            <span class="item-amount ${getAmountClass(item.amount)}">${formatAmount(item.amount)}</span>
                        </div>
                    `;
                });
                
                html += '</div>';
            }

            container.innerHTML = html;
            document.getElementById('totalAssets').textContent = formatAmount(totalAssets);
            return totalAssets;
        }

        // 渲染负债部分
        function renderLiabilities() {
            const container = document.getElementById('liabilityContent');
            const categories = {};
            let totalLiabilities = 0;

            // 按类别分组
            liability_data.forEach(item => {
                const category = item[0];
                const name = item[1];
                const amount = item[2];
                const details = item[3];
                
                if (!categories[category]) {
                    categories[category] = {
                        items: [],
                        total: 0
                    };
                }
                
                categories[category].items.push({ name, amount, details });
                categories[category].total += amount;
                totalLiabilities += amount;
            });

            // 渲染HTML
            let html = '';
            for (const [category, data] of Object.entries(categories)) {
                html += `
                    <div class="category">
                        <div class="category-title">
                            <span>${category}</span>
                            <span class="amount ${getAmountClass(data.total)}">${formatAmount(data.total)}</span>
                        </div>
                `;
                
                data.items.forEach((item, index) => {
                    const itemId = `liability-${category}-${index}`;
                    html += `
                        <div class="item">
                            <span class="item-name">
                                ${item.name}
                                ${item.details ? `<span class="detail-toggle" onclick="toggleDetail('${itemId}')">[详情]</span>` : ''}
                            </span>
                            <span class="item-amount ${getAmountClass(item.amount)}">${formatAmount(item.amount)}</span>
                        </div>
                    `;
                    
                    if (item.details) {
                        html += `<div id="${itemId}" class="detail-content">${item.details}</div>`;
                    }
                });
                
                html += '</div>';
            }

            container.innerHTML = html;
            document.getElementById('totalLiabilities').textContent = formatAmount(totalLiabilities);
            return totalLiabilities;
        }

        // 切换详情显示
        function toggleDetail(id) {
            const element = document.getElementById(id);
            element.classList.toggle('show');
        }

        // 计算并渲染所有者权益
        function renderEquity(totalAssets, totalLiabilities) {
            const paidInCapital = paidin_capital_data;
            const reservesCapital = reserves_capital_data;
            const undistributedProfit = totalAssets - totalLiabilities - paidInCapital - reservesCapital;
            const totalEquity = paidInCapital + reservesCapital + undistributedProfit;

            document.getElementById('paidInCapital').textContent = formatAmount(paidInCapital);
            document.getElementById('reservesCapital').textContent = formatAmount(reservesCapital);
            document.getElementById('undistributedProfit').textContent = formatAmount(undistributedProfit);
            document.getElementById('totalEquity').textContent = formatAmount(totalEquity);
            document.getElementById('summary').textContent = formatSummary([paidInCapital.toFixed(2), totalEquity.toFixed(2), (Math.min(paidInCapital, paidInCapital + undistributedProfit)).toFixed(2), (Math.max(paidInCapital + reservesCapital, paidInCapital + reservesCapital + undistributedProfit)).toFixed(2)]);

            // 设置样式
            document.getElementById('paidInCapital').className = `amount ${getAmountClass(paidInCapital)}`;
            document.getElementById('reservesCapital').className = `amount ${getAmountClass(reservesCapital)}`;
            document.getElementById('undistributedProfit').className = `amount ${getAmountClass(undistributedProfit)}`;

            return totalEquity;
        }

        // 图表相关函数
        class ChartRenderer {
            constructor(canvas, data) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.data = data;
                this.padding = { top: 20, right: 60, bottom: 40, left: 60 };
                this.currentRange = 'all';
                this.filteredData = data;
                
                this.setupEventListeners();
                this.render();
            }

            setupEventListeners() {
                // 时间范围选择
                document.querySelectorAll('.time-selector').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.time-selector').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.currentRange = e.target.dataset.range;
                        this.filterData();
                        this.render();
                    });
                });

                // 鼠标悬停显示详细信息
                this.canvas.addEventListener('mousemove', (e) => {
                    this.handleMouseMove(e);
                });
            }

            filterData() {
                const now = new Date();
                let cutoffDate;

                switch(this.currentRange) {
                    case '1y':
                        cutoffDate = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());
                        break;
                    case '6m':
                        cutoffDate = new Date(now.getFullYear(), now.getMonth() - 6, now.getDate());
                        break;
                    case '3m':
                        cutoffDate = new Date(now.getFullYear(), now.getMonth() - 3, now.getDate());
                        break;
                    default:
                        this.filteredData = this.data;
                        return;
                }

                this.filteredData = this.data.filter(item => {
                    const itemDate = new Date(item[0]);
                    return itemDate >= cutoffDate;
                });
            }

            render() {
                const ctx = this.ctx;
                const canvas = this.canvas;
                
                // 清空画布
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                if (this.filteredData.length === 0) return;

                // 计算绘图区域
                const chartWidth = canvas.width - this.padding.left - this.padding.right;
                const chartHeight = canvas.height - this.padding.top - this.padding.bottom;

                // 计算价格范围
                let minPrice = Infinity;
                let maxPrice = -Infinity;
                
                this.filteredData.forEach(item => {
                    minPrice = Math.min(minPrice, item[2]); // 最低
                    maxPrice = Math.max(maxPrice, item[3]); // 最高
                });

                // 添加一些边距
                const priceRange = maxPrice - minPrice;
                minPrice -= priceRange * 0.1;
                maxPrice += priceRange * 0.1;

                // 绘制网格和坐标轴
                this.drawGrid(chartWidth, chartHeight, minPrice, maxPrice);
                
                // 绘制K线
                this.drawCandlesticks(chartWidth, chartHeight, minPrice, maxPrice);
                
                // 绘制坐标轴标签
                this.drawLabels(chartWidth, chartHeight, minPrice, maxPrice);
            }

            drawGrid(width, height, minPrice, maxPrice) {
                const ctx = this.ctx;
                ctx.strokeStyle = 'rgba(52, 152, 219, 0.2)';
                ctx.lineWidth = 1;

                // 横向网格线
                for (let i = 0; i <= 5; i++) {
                    const y = this.padding.top + (height / 5) * i;
                    ctx.beginPath();
                    ctx.moveTo(this.padding.left, y);
                    ctx.lineTo(this.padding.left + width, y);
                    ctx.stroke();
                }

                // 纵向网格线
                const step = Math.ceil(this.filteredData.length / 10);
                for (let i = 0; i < this.filteredData.length; i += step) {
                    const x = this.padding.left + (width / (this.filteredData.length - 1)) * i;
                    ctx.beginPath();
                    ctx.moveTo(x, this.padding.top);
                    ctx.lineTo(x, this.padding.top + height);
                    ctx.stroke();
                }
            }

            drawCandlesticks(width, height, minPrice, maxPrice) {
                const ctx = this.ctx;
                const candleWidth = Math.max(2, (width / this.filteredData.length) * 0.8);
                
                this.filteredData.forEach((item, index) => {
                    const [date, open, close, low, high] = item;
                    const x = this.padding.left + (width / (this.filteredData.length - 1)) * index;
                    
                    // 计算Y坐标
                    const highY = this.padding.top + height - ((high - minPrice) / (maxPrice - minPrice)) * height;
                    const lowY = this.padding.top + height - ((low - minPrice) / (maxPrice - minPrice)) * height;
                    const openY = this.padding.top + height - ((open - minPrice) / (maxPrice - minPrice)) * height;
                    const closeY = this.padding.top + height - ((close - minPrice) / (maxPrice - minPrice)) * height;
                    
                    // 绘制影线
                    ctx.strokeStyle = close >= open ? '#27ae60' : '#e74c3c';
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(x, highY);
                    ctx.lineTo(x, lowY);
                    ctx.stroke();
                    
                    // 绘制实体
                    ctx.fillStyle = close >= open ? '#27ae60' : '#e74c3c';
                    const bodyTop = Math.min(openY, closeY);
                    const bodyHeight = Math.abs(closeY - openY);
                    
                    if (bodyHeight > 0) {
                        ctx.fillRect(x - candleWidth/2, bodyTop, candleWidth, bodyHeight);
                    } else {
                        // 十字星
                        ctx.strokeRect(x - candleWidth/2, bodyTop - 0.5, candleWidth, 1);
                    }
                });
            }

            drawLabels(width, height, minPrice, maxPrice) {
                const ctx = this.ctx;
                ctx.fillStyle = '#2c3e50';
                ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft YaHei", sans-serif';
                
                // 价格标签
                for (let i = 0; i <= 5; i++) {
                    const price = minPrice + ((maxPrice - minPrice) / 5) * (5 - i);
                    const y = this.padding.top + (height / 5) * i;
                    ctx.fillText(formatAmount(price), this.padding.left - 50, y + 4);
                }

                // 日期标签
                const step = Math.ceil(this.filteredData.length / 8);
                for (let i = 0; i < this.filteredData.length; i += step) {
                    const x = this.padding.left + (width / (this.filteredData.length - 1)) * i;
                    const date = new Date(this.filteredData[i][0]);
                    const dateStr = `${date.getFullYear()}/${date.getMonth() + 1}`;
                    ctx.save();
                    ctx.translate(x, this.padding.top + height + 20);
                    ctx.rotate(-Math.PI / 4);
                    ctx.fillText(dateStr, 0, 0);
                    ctx.restore();
                }
            }

            handleMouseMove(e) {
                const rect = this.canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const chartWidth = this.canvas.width - this.padding.left - this.padding.right;
                const dataIndex = Math.round(((x - this.padding.left) / chartWidth) * (this.filteredData.length - 1));
                
                if (dataIndex >= 0 && dataIndex < this.filteredData.length) {
                    const data = this.filteredData[dataIndex];
                    document.getElementById('chartDate').textContent = `日期: ${data[0]}`;
                    document.getElementById('chartOpen').textContent = `开盘: ${formatAmount(data[1])}`;
                    document.getElementById('chartClose').textContent = `收盘: ${formatAmount(data[2])}`;
                    document.getElementById('chartHigh').textContent = `最高: ${formatAmount(data[3])}`;
                    document.getElementById('chartLow').textContent = `最低: ${formatAmount(data[4])}`;
                }
            }
        }

        // 初始化页面
        function init() {
            showCurrentDate();
            const totalAssets = renderAssets();
            const totalLiabilities = renderLiabilities();
            const totalEquity = renderEquity(totalAssets, totalLiabilities);
            
            // 初始化图表
            const canvas = document.getElementById('chartCanvas');
            new ChartRenderer(canvas, month_data);
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', init);

function resizeCanvas(canvas) {
  const container = canvas.parentElement;
  const dpr = window.devicePixelRatio || 1;
  const rect = container.getBoundingClientRect();
  canvas.width  = rect.width * dpr;
  canvas.height = rect.height * dpr;
  const ctx = canvas.getContext('2d');
  ctx.scale(dpr, dpr);
}

// 在 ChartRenderer 构造函数里先执行一次，并监听 resize
function initChart() {
  const canvas = document.getElementById('chartCanvas');
  resizeCanvas(canvas);
  window.addEventListener('resize', () => {
    resizeCanvas(canvas);
    chart.render();      // 假设 chart 实例已保存
  });
  const chart = new ChartRenderer(canvas, month_data);
  window.chart = chart;  // 供 resize 回调使用
}

// 页面加载完成后初始化
document.addEventListener('DOMContentLoaded', initChart);

    </script>
</body>
</html>